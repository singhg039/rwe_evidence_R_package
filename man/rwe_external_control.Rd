% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/study_design.R
\name{rwe_external_control}
\alias{rwe_external_control}
\title{Create External Control Arm from Historical Data}
\usage{
rwe_external_control(
  external_data,
  treatment_data,
  matching_vars,
  method = c("propensity", "exact", "nearest", "optimal", "caliper"),
  ratio = 1,
  caliper = 0.2,
  replace = FALSE,
  inclusion_criteria = NULL,
  exclusion_criteria = NULL,
  time_window = NULL,
  seed = NULL
)
}
\arguments{
\item{external_data}{Data frame or rwe_data object containing potential control patients}

\item{treatment_data}{Data frame or rwe_data object containing treatment arm patients}

\item{matching_vars}{Character vector of variables to use for matching}

\item{method}{Matching method: "propensity", "exact", "nearest", "optimal", "caliper"}

\item{ratio}{Numeric. Number of controls per treated patient (default: 1)}

\item{caliper}{Numeric. Maximum allowable difference for caliper matching (default: 0.2)}

\item{replace}{Logical. Whether to match with replacement (default: FALSE)}

\item{inclusion_criteria}{List of inclusion criteria (variable = c(min, max) or values)}

\item{exclusion_criteria}{List of exclusion criteria}

\item{time_window}{Numeric vector c(start, end) for temporal restrictions (days)}

\item{seed}{Integer. Random seed for reproducibility}
}
\value{
An object of class \code{rwe_external_control} containing:
\item{matched_controls}{Data frame of matched control patients}
\item{matching_summary}{Summary statistics of matching quality}
\item{balance_assessment}{Covariate balance before and after matching}
\item{inclusion_summary}{Number of patients passing each criterion}
\item{exclusion_summary}{Number of patients excluded by each criterion}
\item{method}{Matching method used}
\item{n_treatment}{Number of treatment patients}
\item{n_controls}{Number of matched controls}
\item{matching_ratio}{Ratio of controls to treatment}
\item{audit_trail}{Audit trail of the selection process}
}
\description{
Generates an external control arm by selecting and matching patients from
historical or external datasets. This function implements several matching
strategies to ensure the external controls are comparable to the treatment arm.
}
\examples{
\dontrun{
# Generate external control arm using propensity score matching
external_controls <- rwe_external_control(
  external_data = historical_data,
  treatment_data = current_study,
  matching_vars = c("age", "sex", "disease_severity"),
  method = "propensity",
  ratio = 2,
  inclusion_criteria = list(
    age = c(18, 75),
    disease_stage = c("I", "II", "III")
  ),
  exclusion_criteria = list(
    prior_treatment = TRUE
  )
)
}

}
